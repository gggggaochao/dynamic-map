<?xml version="1.0" encoding="utf-8"?>
<s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" 
		xmlns:mx="library://ns.adobe.com/flex/mx" 
		currentStateChange="skinCurrentStateChangeHandler(event)" 
		xmlns:componets="com.missiongroup.car.componets.*"
		width="120" height="120">
	<!-- host component -->
	<fx:Metadata>
		[HostComponent("com.missiongroup.car.componets.ArrivedStationRenderer")]
	</fx:Metadata>
	
	<fx:Script>
		<![CDATA[
			import com.missiongroup.car.consts.DisplayMode;
			
			import mx.events.EffectEvent;
			import mx.events.StateChangeEvent;
			
			import spark.filters.GlowFilter;
			
			
			private function fadeEffectEndHandler(event : Event) : void
			{
				myFilter.alphaFrom = myFilter.alphaFrom == 0.8 ? 1 : 0.8;
				myFilter.alphaTo = myFilter.alphaTo == 1 ? 0.8 : 1;
				myFilter.play();
			}
			
			protected function skinCurrentStateChangeHandler(event:StateChangeEvent):void
			{
				if(currentState == DisplayMode.NEXT)
				{
					myFilter.addEventListener(EffectEvent.EFFECT_END,fadeEffectEndHandler);	
					myFilter.play();
				}
				else
				{
					myFilter.removeEventListener(EffectEvent.EFFECT_END,fadeEffectEndHandler);	
					myFilter.end();
					
					group.alpha = 1;
				}
				
			}
			
			
			/**
			 *  @private
			 */
			override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number) : void
			{
				// Push backgroundColor and backgroundAlpha directly.
				// Handle undefined backgroundColor by hiding the background object.
				super.updateDisplayList(unscaledWidth, unscaledHeight);
				stationNormalImage = "assets/skins/icon_"+hostComponent.line+"_a_normal.png";
				stationNextImage = "assets/skins/icon_"+hostComponent.line+"_a_next.png";
			}
			
			[Bindable]
			private var stationNormalImage : String; 
			
			
			[Bindable]
			private var stationNextImage : String;
			
		]]>
	</fx:Script>
	<!-- SkinParts
	name=stationIcon, type=spark.primitives.BitmapImage, required=true
	name=arrowIcon, type=spark.primitives.BitmapImage, required=true
	name=group, type=spark.components.Group, required=true
	name=stationLineIcon, type=spark.primitives.BitmapImage, required=true
	name=stationDisplay, type=spark.components.Label, required=true
	-->
	
	<s:states>
		<s:State name="normal" />
		<s:State name="pass" />
		<s:State name="next" />
	</s:states>
	
	<fx:Declarations>
		
		<s:GlowFilter id="fitler" color="0xffc800" blurX="20" blurY="20" strength="2" quality="1"/>
		
		<s:Fade id="myFilter" target="{group}" alphaTo="1" alphaFrom="0.6" />
		
	</fx:Declarations>	
		
	<s:HGroup id="contentGroup" 
			  top="0" bottom="0" left="0" right="0"
			  verticalAlign="middle"
			  gap="20">

		<s:Group id="group" width="40" height="40">
			
			<componets:UserLineGroup id="userLineGroup" />
			
			<s:BitmapImage source.normal="{stationNormalImage}"
						   source.next="{stationNextImage}" 
						   source.pass="assets/skins/pass2-07.png"
						   horizontalCenter="0"
						   verticalCenter="-5"
						   smooth="true" />
			
			<s:Label id="stationDisplay" 
					 fontSize = "16" fontSize.next="20"  
					 horizontalCenter="0"  
					 color.pass="0x8a8a8a" color.next="0x046eb5" />
			
			
			<s:Label id="stationENDisplay" 
					 fontSize = "8" fontSize.next="10" fontFamily="font_en"
					 horizontalCenter="0"  
					 color.pass="0x8a8a8a" color.next="0x046eb5" />	
			
		</s:Group>
		
	</s:HGroup>
	
</s:Skin>
